{% extends '_base_profile.html' %}

{% load static %}
{% load i18n %}
{% load jalali_tags %}
{% load humanize %}
{% load number_converter %}
{% load widget_tweaks %}

{% block title %}{% trans 'Agent Dashboard' %}{% endblock %}

{% block sidebar_content %}

    <li class="nk-menu-item has-sub">
        <a href="{% url 'agent_profile_info_now' %}" class="nk-menu-link">
            <span class="nk-menu-icon"><em class="icon ni ni-tile-thumb"></em></span>
            <span class="nk-menu-text">{% trans 'Personal Information' %}</span>
        </a>
    </li>

    <li class="nk-menu-item has-sub">
        <a href="#" class="nk-menu-link nk-menu-toggle">
            <span class="nk-menu-icon"><em class="icon ni ni-users"></em></span>
            <span class="nk-menu-text">{% trans 'Tasks List' %}</span>
        </a>
        <ul class="nk-menu-sub">
            <li class="nk-menu-item">
                <a href="{% url 'task_list' %}" class="nk-menu-link"><span class="nk-menu-text">{% trans 'All Tasks' %}</span></a>
            </li>
            <li class="nk-menu-item">
                <a href="{% url 'task_list' %}" class="nk-menu-link"><span class="nk-menu-text">{% trans 'All Tasks' %}</span></a>
            </li>
            <li class="nk-menu-item">
                <a href="{% url 'task_list' %}" class="nk-menu-link"><span class="nk-menu-text">{% trans 'All Tasks' %}</span></a>
            </li>
            <li class="nk-menu-item">
                <a href="{% url 'task_list' %}" class="nk-menu-link"><span class="nk-menu-text">{% trans 'All Tasks' %}</span></a>
            </li>
        </ul>
    </li>

{% endblock %}

{% block content %}

    <div class="nk-block">
        <div class="card card-bordered ">
            <div class="card-aside-wrap">
                <div class="card-inner card-inner-lg">

                    <!-- Title -->
                    <div class="nk-block-head nk-block-head-lg" style="padding-bottom: 0;!important;">
                        <div class="nk-block-between">
                            <div class="nk-block-head-content">
                                <h5 class="nk-block-title" style="font-size: 1.3em;">{% trans 'Personal Information' %}</h5>
                                <div class="nk-block-des">
                                    <p></p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- end: Title -->

                    <!-- Items -->
                    {% if agent_user.complete_info == 'cmp' %}

                        <div class="nk-block">
                            <div class="nk-data data-list">
                                <!-- Info -->
                                <div class="data-item" data-bs-toggle="modal" data-bs-target="#profile-edit">
                                    <div class="data-col">
                                        <span class="data-label" style="font-size: large">{% trans 'Phone Number' %}</span>
                                        <span class="data-value" style="font-size: large">{{ agent_user.phone_number }}</span>
                                    </div>
                                </div>
                                <div class="data-item" data-bs-toggle="modal" data-bs-target="#profile-edit">
                                    <div class="data-col">
                                        <span class="data-label" style="font-size: large">{% trans 'Account Status' %}</span>
                                        <span class="data-value" style="font-size: large; color: #00a65c">
                                            {% trans 'Verified' %}
                                            <p style="font-size: 0.9em; margin-top: 10px;">(شما مشاور همکار هومبابا هستید، جهت تغییر اطلاعات خود، از فرم انتهای صفحه استفاده نمایید)</p>
                                        </span>
                                    </div>
                                </div>
                                <!-- end: Info -->

                                <!-- Tasks -->
                                <div class="nk-block-head nk-block-head-lg" style="margin-top: 4em; padding-bottom: 0;!important;">
                                    <div class="nk-block-between">
                                        <div class="nk-block-head-content">
                                            <h5 class="nk-block-title" style="font-size: 1.3em;">{% trans 'Last Tasks List' %}</h5>
                                            <div class="nk-block-des">
                                                <p></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="pb-2 pb-xl-5 mb-2 mb-xl-5 pt-3">
                                     <div class="row" style="padding-top: 1rem;!important;">
                                         {% for task in tasks %}
                                              <div class="col-6 col-md-4 col-lg-6 col-xl-4 has-xxl-5 mb-3 mb-lg-4">
                                                  <div class="p-2 rounded-6 shadow-dark-80 bg-white mb-0 h-100 border border-gray-200">

                                                      <div class="mb-2 d-flex align-items-center">
                                                          <span class="badge badge-sm badge-soft-primary">19 فایل</span>
                                                      </div>

                                                      <div class="text-center">
                                                          <div class="circle circle-xl mx-auto">
                                                              <!-- Title -->
                                                              <div style="height: 4.5em; -webkit-line-clamp: 2;">
                                                                  <!-- Services title -->
                                                                  {% if task.type == 'vis' %}
                                                                      <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                          {{ task.get_type_display }} {% trans 'in' %} {{ task.task_visit.get_city_display }} - {{ task.task_visit.district }} | {{ task.task_visit.get_date_display }} | {{ task.task_visit.get_time_display }}
                                                                      </h6></a>
                                                                  {% elif task.type == 'ses' %}
                                                                      <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                          {{ task.get_type_display }} {% trans 'in' %} {{ task.task_session.get_city_display }} - {{ task.task_session.district }} | {{ task.task_session.get_date_display }} | {{ task.task_session.get_time_display }}
                                                                      </h6></a>
                                                                  {% elif task.type == 'cns' %}
                                                                      {% if task.task_counseling.counseling_type == 'ip' %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {{ task.task_counseling.get_counseling_type_display }} {% trans 'in hombaba (tehran)' %} | {{ task.task_counseling.get_date_display }} | {{ task.task_counseling.get_time_display }}
                                                                          </h6></a>
                                                                      {% else %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {{ task.task_counseling.get_counseling_type_display }} | {{ task.task_counseling.get_date_display }} | {{ task.task_counseling.get_time_display }}
                                                                          </h6></a>
                                                                      {% endif %}
                                                                      <!-- trade session title -->
                                                                  {% elif task.type == 'tds' %}
                                                                      {% if task.task_trade_session.location == 'ours' %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {% trans 'in hombaba (tehran)' %} | {{ task.task_trade_session.get_date_display }} | {{ task.task_trade_session.get_time_display }}
                                                                          </h6></a>
                                                                      {% else %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {% trans 'in' %} {{ task.task_trade_session.get_city_display }} - {{ task.task_trade_session.district }}  | {{ task.task_trade_session.get_date_display }} | {{ task.task_trade_session.get_time_display }}
                                                                          </h6></a>
                                                                      {% endif %}
                                                                  {% endif %}
                                                              </div>

                                                              <!-- Pricing -->
                                                              <div style="margin: 1.2em 0;">
                                                                  <!-- Counseling -->
                                                                  {% if task.type == 'cns' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">{{ task.task_counseling.price|intcomma:False|farsi_number }} {% trans 'Tooman' %}</h6>
                                                                  <!-- Counseling -->
                                                                  {% elif task.type == 'ses' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">{{ task.task_session.price|intcomma:False|farsi_number }} {% trans 'Tooman' %}</h6>
                                                                  <!-- Visit -->
                                                                  {% elif task.type == 'vis' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">{{ task.task_visit.price|intcomma:False|farsi_number }} {% trans 'Tooman' %}</h6>
                                                                  <!-- TS -->
                                                                  {% elif task.type == 'tds' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">0/25 درصد مبلغ معامله</h6>
                                                                  {% endif %}
                                                              </div>

                                                              <!-- Request status -->
                                                              <div class="pt-4 pb-4">
                                                                  {% if task.is_requested == 'fre' %}
                                                                      <span class="small font-weight-semibold mb-2 d-block">{{ task.get_is_requested_display }}</span>
                                                                      <div class="progress rounded-pill" style="height: 5px;width: 100%;">
                                                                          <div class="progress-bar bg-teal-500" role="progressbar" style="width: 33%; background-color: #00A65C;" aria-valuenow="33" aria-valuemin="0" aria-valuemax="100"></div>
                                                                      </div>
                                                                  {% elif task.is_requested == 'pen' %}
                                                                      <span class="small font-weight-semibold mb-2 d-block">{{ task.get_is_requested_display }}</span>
                                                                      <div class="progress rounded-pill" style="height: 5px;width: 100%;">
                                                                          <div class="progress-bar bg-teal-500" role="progressbar" style="width: 66%; background-color: #FFA726;" aria-valuenow="66" aria-valuemin="0" aria-valuemax="100"></div>
                                                                      </div>
                                                                  {% elif task.is_requested == 'tkn' %}
                                                                      <span class="small font-weight-semibold mb-2 d-block">{{ task.get_is_requested_display }}</span>
                                                                      <div class="progress rounded-pill" style="height: 5px;width: 100%;">
                                                                            <div class="progress-bar bg-teal-500" role="progressbar" style="width: 99%; background-color: grey" aria-valuenow="99" aria-valuemin="0" aria-valuemax="100"></div>
                                                                      </div>
                                                                  {% endif %}
                                                              </div>

                                                          </div>
                                                      </div>
                                                  </div>
                                          </div>
                                         {% endfor %}
                                     </div>
                                    <div class="align-items-center center" style="margin-top: 20px;">
                                        <a href="{% url 'task_list' %}" class="btn btn-primary" style="padding: 5px 45px; line-height: 2.5em;!important;">برای مشاهده تمام فرصت‌های کاری، کلیک نمایید</a>
                                    </div>
                                </div>
                                <!-- end: Tasks -->

                                <!-- Edit Form -->
                                <div class="nk-block-head nk-block-head-lg" style="margin-top: 4em; padding-bottom: 0;!important;">
                                    <div class="nk-block-between">
                                        <div class="nk-block-head-content">
                                            <h5 class="nk-block-title" style="font-size: 1.3em;">تغییر اطلاعات مشاور</h5>
                                            <div class="nk-block-des">
                                                <p></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <form method="post" class="px-3 form-style-two" style="margin-top: 1.5em;" novalidate>
                                    {% csrf_token %}

                                    <div class="row">
                                        <!-- Email -->
                                        <div class="col-sm-6 mb-md-4 pb-3">
                                            <label for="{{ form.email.id_for_label }}" class="form-label form-label-lg">{% trans 'Email' %}</label>
                                            {% render_field form.email type="text" id="email" class="form-control form-control-xl" %}
                                            {% if form.email.errors %}
                                                {% for error in form.email.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Fixed Phone Number -->
                                        <div class="col-sm-6 mb-md-4 pb-3">
                                            <label for="{{ form.fixed_phone_number.id_for_label }}" class="form-label form-label-lg">{% trans 'Fixed Phone Number' %}</label>
                                            {% render_field form.fixed_phone_number type="text" id="fixed_phone_number" class="form-control form-control-xl" %}
                                            {% if form.fixed_phone_number.errors %}
                                                {% for error in form.fixed_phone_number.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Province -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.province.id_for_label }}" class="form-label form-label-lg">{% trans 'Province' %}</label>
                                            {% render_field form.province type="text" id="province" class="form-control form-control-xl" %}
                                            {% if form.province.errors %}
                                                {% for error in form.province.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- City -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.city.id_for_label }}" class="form-label form-label-lg">{% trans 'City' %}</label>
                                            {% render_field form.city type="text" id="city" class="form-control form-control-xl" %}
                                            {% if form.city.errors %}
                                                {% for error in form.city.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Postal Code -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.postal_code.id_for_label }}" class="form-label form-label-lg">{% trans 'Postal Code' %}</label>
                                            {% render_field form.postal_code type="text" id="postal_code" class="form-control form-control-xl" %}
                                            {% if form.postal_code.errors %}
                                                {% for error in form.postal_code.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Address -->
                                        <div class="col-sm-12 mb-md-4 pb-3">
                                            <label for="{{ form.address.id_for_label }}" class="form-label form-label-lg">{% trans 'Address' %}</label>
                                            {% render_field form.address type="text" id="address" class="form-control form-control-xl" %}
                                            {% if form.address.errors %}
                                                {% for error in form.address.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Bank Card -->
                                        <div class="col-sm-6 mb-md-4 pb-3">
                                            <label for="{{ form.bank_card.id_for_label }}" class="form-label form-label-lg">{% trans 'Bank Card' %}</label>
                                            {% render_field form.bank_card type="file" id="bank_card" class="form-control form-control-xl" %}
                                            {% if form.bank_card.errors %}
                                                {% for error in form.bank_card.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Bank Sheba -->
                                        <div class="col-sm-6 mb-md-4 pb-3">
                                            <label for="{{ form.bank_sheba.id_for_label }}" class="form-label form-label-lg">{% trans 'Bank Sheba' %}</label>
                                            {% render_field form.bank_sheba type="text" id="bank_sheba" class="form-control form-control-xl" %}
                                            {% if form.bank_sheba.errors %}
                                                {% for error in form.bank_sheba.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                    </div>

                                    <div class="text-end py-md-3">
                                        <button type="submit" class="btn btn-lg btn-primary px-md-4 mt-lg-3">
                                            <span class="px-md-3">{% trans 'Submit' %}</span>
                                        </button>
                                    </div>
                                </form>
                                <!-- end: Edit Form -->

                                <!-- JS autoupdate -->
                                <script>
                                    $(document).ready(function() {
                                        $('#district').hide();

                                        $('#province').change(function() {
                                            var provinceId = $(this).val();
                                            $.ajax({
                                                url: '/load_cities/',
                                                data: {
                                                    'province': provinceId
                                                },
                                                success: function(data) {
                                                    $('#city').html('');
                                                    $.each(data.cities, function(index, city) {
                                                        $('#city').append(`<option value="${city[0]}">${city[1]}</option>`);
                                                    });
                                                    $('#city').trigger('change');
                                                }
                                            });
                                        });
                                    });
                                </script>
                                <!-- JS autoupdate -->

                            </div>
                        </div>

                    {% elif agent_user.complete_info == 'ipr' %}

                        <div class="nk-block">
                            <div class="nk-data data-list">
                                <!-- Info -->
                                <div class="data-item" data-bs-toggle="modal" data-bs-target="#profile-edit">
                                    <div class="data-col">
                                        <span class="data-label" style="font-size: large">{% trans 'Phone Number' %}</span>
                                        <span class="data-value" style="font-size: large">{{ agent_user.phone_number }}</span>
                                    </div>
                                </div>
                                <div class="data-item" data-bs-toggle="modal" data-bs-target="#profile-edit">
                                    <div class="data-col">
                                        <span class="data-label" style="font-size: large">{% trans 'Account Status' %}</span>
                                        <span class="data-value" style="font-size: large; color: #99a025;">
                                            {% trans 'In Progress' %}
                                            <p style="font-size: 0.9em; margin-top: 10px;">(اطلاعات شما دریافت شده و فرایند تایید شما به عنوان مشاور همکار هومبابا، در حال انجام است)</p>
                                        </span>
                                    </div>
                                </div>
                                <!-- end: Info -->

                                <!-- Tasks -->
                                <div class="nk-block-head nk-block-head-lg" style="margin-top: 4em; padding-bottom: 0;!important;">
                                    <div class="nk-block-between">
                                        <div class="nk-block-head-content">
                                            <h5 class="nk-block-title" style="font-size: 1.3em;">{% trans 'Last Tasks List' %}</h5>
                                            <div class="nk-block-des">
                                                <p></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="pb-2 pb-xl-5 mb-2 mb-xl-5 pt-3">
                                     <div class="row" style="padding-top: 1rem;!important;">
                                         {% for task in tasks %}
                                              <div class="col-6 col-md-4 col-lg-6 col-xl-4 has-xxl-5 mb-3 mb-lg-4">
                                                  <div class="p-2 rounded-6 shadow-dark-80 bg-white mb-0 h-100 border border-gray-200">

                                                      <div class="mb-2 d-flex align-items-center">
                                                          <span class="badge badge-sm badge-soft-primary">19 فایل</span>
                                                      </div>

                                                      <div class="text-center">
                                                          <div class="circle circle-xl mx-auto">
                                                              <!-- Title -->
                                                              <div style="height: 4.5em; -webkit-line-clamp: 2;">
                                                                  <!-- Services title -->
                                                                  {% if task.type == 'vis' %}
                                                                      <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                          {{ task.get_type_display }} {% trans 'in' %} {{ task.task_visit.get_city_display }} - {{ task.task_visit.district }} | {{ task.task_visit.get_date_display }} | {{ task.task_visit.get_time_display }}
                                                                      </h6></a>
                                                                  {% elif task.type == 'ses' %}
                                                                      <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                          {{ task.get_type_display }} {% trans 'in' %} {{ task.task_session.get_city_display }} - {{ task.task_session.district }} | {{ task.task_session.get_date_display }} | {{ task.task_session.get_time_display }}
                                                                      </h6></a>
                                                                  {% elif task.type == 'cns' %}
                                                                      {% if task.task_counseling.counseling_type == 'ip' %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {{ task.task_counseling.get_counseling_type_display }} {% trans 'in hombaba (tehran)' %} | {{ task.task_counseling.get_date_display }} | {{ task.task_counseling.get_time_display }}
                                                                          </h6></a>
                                                                      {% else %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {{ task.task_counseling.get_counseling_type_display }} | {{ task.task_counseling.get_date_display }} | {{ task.task_counseling.get_time_display }}
                                                                          </h6></a>
                                                                      {% endif %}
                                                                      <!-- trade session title -->
                                                                  {% elif task.type == 'tds' %}
                                                                      {% if task.task_trade_session.location == 'ours' %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {% trans 'in hombaba (tehran)' %} | {{ task.task_trade_session.get_date_display }} | {{ task.task_trade_session.get_time_display }}
                                                                          </h6></a>
                                                                      {% else %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {% trans 'in' %} {{ task.task_trade_session.get_city_display }} - {{ task.task_trade_session.district }}  | {{ task.task_trade_session.get_date_display }} | {{ task.task_trade_session.get_time_display }}
                                                                          </h6></a>
                                                                      {% endif %}
                                                                  {% endif %}
                                                              </div>

                                                              <!-- Pricing -->
                                                              <div style="margin: 1.2em 0;">
                                                                  <!-- Counseling -->
                                                                  {% if task.type == 'cns' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">{{ task.task_counseling.price|intcomma:False|farsi_number }} {% trans 'Tooman' %}</h6>
                                                                  <!-- Counseling -->
                                                                  {% elif task.type == 'ses' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">{{ task.task_session.price|intcomma:False|farsi_number }} {% trans 'Tooman' %}</h6>
                                                                  <!-- Visit -->
                                                                  {% elif task.type == 'vis' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">{{ task.task_visit.price|intcomma:False|farsi_number }} {% trans 'Tooman' %}</h6>
                                                                  <!-- TS -->
                                                                  {% elif task.type == 'tds' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">0/25 درصد مبلغ معامله</h6>
                                                                  {% endif %}
                                                              </div>

                                                              <!-- Request status -->
                                                              <div class="pt-4 pb-4">
                                                                  {% if task.is_requested == 'fre' %}
                                                                      <span class="small font-weight-semibold mb-2 d-block">{{ task.get_is_requested_display }}</span>
                                                                      <div class="progress rounded-pill" style="height: 5px;width: 100%;">
                                                                          <div class="progress-bar bg-teal-500" role="progressbar" style="width: 33%; background-color: #00A65C;" aria-valuenow="33" aria-valuemin="0" aria-valuemax="100"></div>
                                                                      </div>
                                                                  {% elif task.is_requested == 'pen' %}
                                                                      <span class="small font-weight-semibold mb-2 d-block">{{ task.get_is_requested_display }}</span>
                                                                      <div class="progress rounded-pill" style="height: 5px;width: 100%;">
                                                                          <div class="progress-bar bg-teal-500" role="progressbar" style="width: 66%; background-color: #FFA726;" aria-valuenow="66" aria-valuemin="0" aria-valuemax="100"></div>
                                                                      </div>
                                                                  {% elif task.is_requested == 'tkn' %}
                                                                      <span class="small font-weight-semibold mb-2 d-block">{{ task.get_is_requested_display }}</span>
                                                                      <div class="progress rounded-pill" style="height: 5px;width: 100%;">
                                                                            <div class="progress-bar bg-teal-500" role="progressbar" style="width: 99%; background-color: grey" aria-valuenow="99" aria-valuemin="0" aria-valuemax="100"></div>
                                                                      </div>
                                                                  {% endif %}
                                                              </div>

                                                          </div>
                                                      </div>
                                                  </div>
                                          </div>
                                         {% endfor %}
                                     </div>
                                    <div class="align-items-center center" style="margin-top: 20px;">
                                        <a href="{% url 'task_list' %}" class="btn btn-primary" style="padding: 5px 45px; line-height: 2.5em;!important;">برای مشاهده تمام فرصت‌های کاری، کلیک نمایید</a>
                                    </div>
                                </div>
                                <!-- end: Tasks -->
                            </div>
                        </div>

                    {% elif agent_user.complete_info == 'dnt' %}

                        <div class="nk-block">
                            <div class="nk-data data-list ">

                                <!-- Info -->
                                <div class="data-item" data-bs-toggle="modal" data-bs-target="#profile-edit">
                                    <div class="data-col">
                                        <span class="data-label" style="font-size: large">{% trans 'Phone Number' %}</span>
                                        <span class="data-value" style="font-size: large">{{ agent_user.phone_number }}</span>
                                    </div>
                                </div>

                                <div class="data-item">
                                    <div class="data-col">
                                        <span class="data-label" style="font-size: large">{% trans 'Account Status' %}</span>
                                        <span class="data-value" style="font-size: large; color: #db4646;">
                                            {% trans 'Not Completed' %}
                                            <p style="font-size: 0.9em; margin-top: 10px;">(برای ادامه باید اطلاعات فرم انتهای صفحه را تکمیل نمایید)</p>
                                        </span>
                                    </div>
                                </div>
                                <!-- end: Info -->

                                <!-- Tasks -->
                                <div class="nk-block-head nk-block-head-lg" style="margin-top: 4em; padding-bottom: 0;!important;">
                                    <div class="nk-block-between">
                                        <div class="nk-block-head-content">
                                            <h5 class="nk-block-title" style="font-size: 1.3em;">{% trans 'Last Tasks List' %}</h5>
                                            <div class="nk-block-des">
                                                <p></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="pb-2 pb-xl-5 mb-2 mb-xl-5 pt-3">
                                     <div class="row" style="padding-top: 1rem;!important;">
                                         {% for task in tasks %}
                                              <div class="col-6 col-md-4 col-lg-6 col-xl-4 has-xxl-5 mb-3 mb-lg-4">
                                                  <div class="p-2 rounded-6 shadow-dark-80 bg-white mb-0 h-100 border border-gray-200">

                                                      <div class="mb-2 d-flex align-items-center">
                                                          <span class="badge badge-sm badge-soft-primary">19 فایل</span>
                                                      </div>

                                                      <div class="text-center">
                                                          <div class="circle circle-xl mx-auto">
                                                              <!-- Title -->
                                                              <div style="height: 4.5em; -webkit-line-clamp: 2;">
                                                                  <!-- Services title -->
                                                                  {% if task.type == 'vis' %}
                                                                      <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                          {{ task.get_type_display }} {% trans 'in' %} {{ task.task_visit.get_city_display }} - {{ task.task_visit.district }} | {{ task.task_visit.get_date_display }} | {{ task.task_visit.get_time_display }}
                                                                      </h6></a>
                                                                  {% elif task.type == 'ses' %}
                                                                      <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                          {{ task.get_type_display }} {% trans 'in' %} {{ task.task_session.get_city_display }} - {{ task.task_session.district }} | {{ task.task_session.get_date_display }} | {{ task.task_session.get_time_display }}
                                                                      </h6></a>
                                                                  {% elif task.type == 'cns' %}
                                                                      {% if task.task_counseling.counseling_type == 'ip' %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {{ task.task_counseling.get_counseling_type_display }} {% trans 'in hombaba (tehran)' %} | {{ task.task_counseling.get_date_display }} | {{ task.task_counseling.get_time_display }}
                                                                          </h6></a>
                                                                      {% else %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {{ task.task_counseling.get_counseling_type_display }} | {{ task.task_counseling.get_date_display }} | {{ task.task_counseling.get_time_display }}
                                                                          </h6></a>
                                                                      {% endif %}
                                                                      <!-- trade session title -->
                                                                  {% elif task.type == 'tds' %}
                                                                      {% if task.task_trade_session.location == 'ours' %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {% trans 'in hombaba (tehran)' %} | {{ task.task_trade_session.get_date_display }} | {{ task.task_trade_session.get_time_display }}
                                                                          </h6></a>
                                                                      {% else %}
                                                                          <a href="{{ task.get_absolute_url }}"><h6 style="line-height: 1.5em;!important;" class="font-weight-semibold title-box">
                                                                              {{ task.get_type_display }} {% trans 'in' %} {{ task.task_trade_session.get_city_display }} - {{ task.task_trade_session.district }}  | {{ task.task_trade_session.get_date_display }} | {{ task.task_trade_session.get_time_display }}
                                                                          </h6></a>
                                                                      {% endif %}
                                                                  {% endif %}
                                                              </div>

                                                              <!-- Pricing -->
                                                              <div style="margin: 1.2em 0;">
                                                                  <!-- Counseling -->
                                                                  {% if task.type == 'cns' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">{{ task.task_counseling.price|intcomma:False|farsi_number }} {% trans 'Tooman' %}</h6>
                                                                  <!-- Counseling -->
                                                                  {% elif task.type == 'ses' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">{{ task.task_session.price|intcomma:False|farsi_number }} {% trans 'Tooman' %}</h6>
                                                                  <!-- Visit -->
                                                                  {% elif task.type == 'vis' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">{{ task.task_visit.price|intcomma:False|farsi_number }} {% trans 'Tooman' %}</h6>
                                                                  <!-- TS -->
                                                                  {% elif task.type == 'tds' %}
                                                                      <p class="font-weight-semibold title-box">{% trans 'Total price: ' %}</p>
                                                                      <h6 style="color: #00a65c;">0/25 درصد مبلغ معامله</h6>
                                                                  {% endif %}
                                                              </div>

                                                              <!-- Request status -->
                                                              <div class="pt-4 pb-4">
                                                                  {% if task.is_requested == 'fre' %}
                                                                      <span class="small font-weight-semibold mb-2 d-block">{{ task.get_is_requested_display }}</span>
                                                                      <div class="progress rounded-pill" style="height: 5px;width: 100%;">
                                                                          <div class="progress-bar bg-teal-500" role="progressbar" style="width: 33%; background-color: #00A65C;" aria-valuenow="33" aria-valuemin="0" aria-valuemax="100"></div>
                                                                      </div>
                                                                  {% elif task.is_requested == 'pen' %}
                                                                      <span class="small font-weight-semibold mb-2 d-block">{{ task.get_is_requested_display }}</span>
                                                                      <div class="progress rounded-pill" style="height: 5px;width: 100%;">
                                                                          <div class="progress-bar bg-teal-500" role="progressbar" style="width: 66%; background-color: #FFA726;" aria-valuenow="66" aria-valuemin="0" aria-valuemax="100"></div>
                                                                      </div>
                                                                  {% elif task.is_requested == 'tkn' %}
                                                                      <span class="small font-weight-semibold mb-2 d-block">{{ task.get_is_requested_display }}</span>
                                                                      <div class="progress rounded-pill" style="height: 5px;width: 100%;">
                                                                            <div class="progress-bar bg-teal-500" role="progressbar" style="width: 99%; background-color: grey" aria-valuenow="99" aria-valuemin="0" aria-valuemax="100"></div>
                                                                      </div>
                                                                  {% endif %}
                                                              </div>

                                                          </div>
                                                      </div>
                                                  </div>
                                          </div>
                                         {% endfor %}
                                     </div>
                                    <div class="align-items-center center" style="margin-top: 20px;">
                                        <a href="{% url 'task_list' %}" class="btn btn-primary" style="padding: 5px 45px; line-height: 2.5em;!important;">برای مشاهده تمام فرصت‌های کاری، کلیک نمایید</a>
                                    </div>
                                </div>
                                <!-- end: Tasks -->

                                <!-- Form -->
                                <div class="nk-block-head nk-block-head-lg" style="margin-top: 4em; padding-bottom: 0;!important;">
                                    <div class="nk-block-between">
                                        <div class="nk-block-head-content">
                                            <h5 class="nk-block-title" style="font-size: 1.3em;">تکمیل اطلاعات مشاور</h5>
                                            <div class="nk-block-des">
                                                <p></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <form method="post" class="px-3 form-style-two" style="margin-top: 1.5em;" novalidate>
                                    {% csrf_token %}

                                    <div class="row">
                                        <!-- First Name -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.f_name.id_for_label }}" class="form-label form-label-lg">{% trans 'First Name' %}</label>
                                            {% render_field form.f_name type="text" id="f_name" class="form-control form-control-xl" %}
                                            {% if form.f_name.errors %}
                                                {% for error in form.f_name.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Last Name -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.l_name.id_for_label }}" class="form-label form-label-lg">{% trans 'Last Name' %}</label>
                                            {% render_field form.l_name type="text" id="l_name" class="form-control form-control-xl" %}
                                            {% if form.l_name.errors %}
                                                {% for error in form.l_name.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Sex -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.sex.id_for_label }}" class="form-label form-label-lg">{% trans 'Sex' %}</label>
                                            {% render_field form.sex type="text" id="sex" class="form-control form-control-xl" %}
                                            {% if form.sex.errors %}
                                                {% for error in form.sex.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- National Code -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.national_code.id_for_label }}" class="form-label form-label-lg">{% trans 'National Code' %}</label>
                                            {% render_field form.national_code type="text" id="national_code" class="form-control form-control-xl" %}
                                            {% if form.national_code.errors %}
                                                {% for error in form.national_code.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Email -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.email.id_for_label }}" class="form-label form-label-lg">{% trans 'Email' %}</label>
                                            {% render_field form.email type="text" id="email" class="form-control form-control-xl" %}
                                            {% if form.email.errors %}
                                                {% for error in form.email.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Fixed Phone Number -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.fixed_phone_number.id_for_label }}" class="form-label form-label-lg">{% trans 'Fixed Phone Number' %}</label>
                                            {% render_field form.fixed_phone_number type="text" id="fixed_phone_number" class="form-control form-control-xl" %}
                                            {% if form.fixed_phone_number.errors %}
                                                {% for error in form.fixed_phone_number.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Province -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.province.id_for_label }}" class="form-label form-label-lg">{% trans 'Province' %}</label>
                                            {% render_field form.province type="text" id="province" class="form-control form-control-xl" %}
                                            {% if form.province.errors %}
                                                {% for error in form.province.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- City -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.city.id_for_label }}" class="form-label form-label-lg">{% trans 'City' %}</label>
                                            {% render_field form.city type="text" id="city" class="form-control form-control-xl" %}
                                            {% if form.city.errors %}
                                                {% for error in form.city.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Postal Code -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.postal_code.id_for_label }}" class="form-label form-label-lg">{% trans 'Postal Code' %}</label>
                                            {% render_field form.postal_code type="text" id="postal_code" class="form-control form-control-xl" %}
                                            {% if form.postal_code.errors %}
                                                {% for error in form.postal_code.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Address -->
                                        <div class="col-sm-12 mb-md-4 pb-3">
                                            <label for="{{ form.address.id_for_label }}" class="form-label form-label-lg">{% trans 'Address' %}</label>
                                            {% render_field form.address type="text" id="address" class="form-control form-control-xl" %}
                                            {% if form.address.errors %}
                                                {% for error in form.address.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- National Card -->
                                        <div class="col-sm-6 mb-md-4 pb-3">
                                            <label for="{{ form.national_card.id_for_label }}" class="form-label form-label-lg">{% trans 'National Card' %}</label>
                                            {% render_field form.national_card type="file" id="national_card" class="form-control form-control-xl" %}
                                            {% if form.national_card.errors %}
                                                {% for error in form.national_card.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Auth Picture -->
                                        <div class="col-sm-6 mb-md-4 pb-3">
                                            <label for="{{ form.auth_picture.id_for_label }}" class="form-label form-label-lg">{% trans 'Auth Picture' %}</label>
                                            {% render_field form.auth_picture type="file" id="auth_picture" class="form-control form-control-xl" %}
                                            {% if form.auth_picture.errors %}
                                                {% for error in form.auth_picture.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Bank Card -->
                                        <div class="col-sm-6 mb-md-4 pb-3">
                                            <label for="{{ form.bank_card.id_for_label }}" class="form-label form-label-lg">{% trans 'Bank Card' %}</label>
                                            {% render_field form.bank_card type="file" id="bank_card" class="form-control form-control-xl" %}
                                            {% if form.bank_card.errors %}
                                                {% for error in form.bank_card.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Bank Sheba -->
                                        <div class="col-sm-6 mb-md-4 pb-3">
                                            <label for="{{ form.bank_sheba.id_for_label }}" class="form-label form-label-lg">{% trans 'Bank Sheba' %}</label>
                                            {% render_field form.bank_sheba type="text" id="bank_sheba" class="form-control form-control-xl" %}
                                            {% if form.bank_sheba.errors %}
                                                {% for error in form.bank_sheba.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Experience -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.experience.id_for_label }}" class="form-label form-label-lg">{% trans 'Experience' %}</label>
                                            {% render_field form.experience type="text" id="experience" class="form-control form-control-xl" %}
                                            {% if form.experience.errors %}
                                                {% for error in form.experience.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Course Tendency -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.course_tendency.id_for_label }}" class="form-label form-label-lg">{% trans 'Course Tendency' %}</label>
                                            {% render_field form.course_tendency type="text" id="course_tendency" class="form-control form-control-xl" %}
                                            {% if form.course_tendency.errors %}
                                                {% for error in form.course_tendency.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                        <!-- Introduction Way -->
                                        <div class="col-sm-4 mb-md-4 pb-3">
                                            <label for="{{ form.introduction_way.id_for_label }}" class="form-label form-label-lg">{% trans 'Introduction Way' %}</label>
                                            {% render_field form.introduction_way type="text" id="introduction_way" class="form-control form-control-xl" %}
                                            {% if form.introduction_way.errors %}
                                                {% for error in form.introduction_way.errors %}
                                                    <p style="color: red; margin-top: 0.8em; font-size: 0.9em;">{{ error }}</p>
                                                {% endfor %}
                                            {% endif %}
                                        </div>

                                    </div>

                                    <div class="text-end py-md-3">
                                        <button type="submit" class="btn btn-lg btn-primary px-md-4 mt-lg-3">
                                            <span class="px-md-3">{% trans 'Submit' %}</span>
                                        </button>
                                    </div>
                                </form>
                                <!-- end: Form -->

                                <!-- JS autoupdate -->
                                <script>
                                    $(document).ready(function() {
                                        $('#district').hide();

                                        $('#province').change(function() {
                                            var provinceId = $(this).val();
                                            $.ajax({
                                                url: '/load_cities/',
                                                data: {
                                                    'province': provinceId
                                                },
                                                success: function(data) {
                                                    $('#city').html('');
                                                    $.each(data.cities, function(index, city) {
                                                        $('#city').append(`<option value="${city[0]}">${city[1]}</option>`);
                                                    });
                                                    $('#city').trigger('change');
                                                }
                                            });
                                        });
                                    });
                                </script>
                                <!-- JS autoupdate -->

                            </div>
                        </div>

                    {% endif %}
                    <!-- end: Items -->

                </div>
            </div>
        </div>
    </div>

{% endblock %}


